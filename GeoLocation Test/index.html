<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Get Location</title>
	<!-- jQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>
</head>
<body>
	<a href="#" id="get_location">Get Location</a>
	<div id="map">
		<iframe id="google_map" width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com?output=embed" frameborder="0"></iframe>
	</div>
	<div id="location_details">
		
	</div>
	
	<script src="js/geoposition.js"></script>
	<script src="js/modernizr.js"></script>
	<script>

	//VIDEO 1
	//=========================================================================================
		/*var c = function(position) {
			var latitude = position.coords.latitude,
			longitude = position.coords.longitude
			coords = latitude + ", " + longitude;

			document.getElementById("google_map").setAttribute("src", "https://maps.google.com/?q=" + coords + "&z=16&output=embed");

			document.getElementById("location_details").innerHTML = 
			"<h2> Your Coordinates </h2>" + 
			"<p>" + coords + "</p>";

		}

		document.getElementById("get_location").onclick = function() {
			navigator.geolocation.getCurrentPosition(c);
			return false;
		}*/

	//VIDEO 2
	//=========================================================================================
		/*var moment = require("moment");*/

		var getCurrentDate = () => {
			var currentDate = moment().utc().format("MM/d/YYYY");
			return currentDate;
		};

		var getCurrentTime = () => {
			var currentTime = moment().utc().format("H:mm:ss");
			return currentTime;
		};

		var getLocation = (repeater) => {

			var c = function(position) {
				var latitude = position.coords.latitude,
				longitude = position.coords.longitude,
				accuracy = position.coords.accuracy,
				coords = latitude + ", " + longitude;

				document.getElementById("google_map").setAttribute("src", "https://maps.google.com/?q=" + coords + "&z=16&output=embed");

				var userLocation = {
					"userName": "username",
					"date": getCurrentDate(),
					"time": getCurrentTime(),
					"coordinates": coords,
					"latitude": longitude,
					"longitude": latitude,
					"accuracy": accuracy
				};

				$.post("api/new/userTimeAndLocation", userLocation, 'json')
				.done(function(response) {
					console.log("User Name: " + response.userName);
					console.log("Date: " + response.date);
					console.log("Time: " + response.time);
					console.log("Coordinates: " + response.coordinates);
					console.log("Latitude: " + response.latitude);
					console.log("Longitude: " + response.longitude);
					console.log("Accuracy: " + response.accuracy + " feet");
					console.log("\n");
				});

				/*console.log("User ID: ");
				console.log("Date: " + getCurrentDate());
				console.log("Time: " + getCurrentTime());
				console.log("Coordinates: " + coords);
				console.log("Latitude: ");
				console.log("Longitude: ");
				console.log("Country: ");
				console.log("Municipality: ");
				console.log("City: ");
				console.log("Accuracy: " + accuracy + " feet");
				console.log("\n");*/

				if (repeater) {
					repeater();
				}

			};

			navigator.geolocation.getCurrentPosition(c, e, {
				enableHighAccuracy: true,
				maximumAge: 60000,
				timeout: 2000
			});
			return false;
		};

		var e = function(error) {
			if (error.code === 1 ) {
				alert("unable to get location");
			} else if (error.code === 2) {
				alert("Internet connection failed.");
			} else if (error.code === 3) {
				alert("connection timed out");
			}
		}

		$("#get_location").on("click", function() {
			getLocation();
		});

		var repeater = () => {
			var counter = 0;
			var repeatLocation = setInterval(() => {
				getLocation();
				counter++;
				if (counter >= 5) {
					clearInterval(repeatLocation);
				}
			}, 5000);
		};

		var somefunction = function() {
	console.log("this is a basic function");
};

		$(document).ready(() => {
			getLocation(repeater);
		
		})

		
	//VIDEO 3
	//=========================================================================================

		/*if (!Modernizr.geolocation) {
			alert("Geolocation Not Supported");
		} else {
			var c = function(position) {
				var latitude = position.coords.latitude,
				longitude = position.coords.longitude,
				accuracy = position.coords.accuracy,
				coords = latitude + ", " + longitude;



				document.getElementById("google_map").setAttribute("src", "https://maps.google.com/?q=" + coords + "&z=16&output=embed");

				document.getElementById("location_details").innerHTML = 
				"<h2> Your Coordinates </h2>" + 
				"<p>" + coords + "</p>" +
				"<p> Accuracy: " + accuracy + " feet</p>";

			};

			var e = function(error) {
				if (error.code === 1 ) {
					alert("unable to get location");
				} else if (error.code === 2) {
					alert("Internet connection failed.");
				} else if (error.code === 3) {
					alert("connection timed out");
				}
			}

			document.getElementById("get_location").onclick = function() {
				navigator.geolocation.getCurrentPosition(c, e, {
					enableHighAccuracy: true,
					maximumAge: 60000,
					timeout: 500
				});
				return false;
			};
		}*/

	//VIDEO 4 - Geoposition.js
	//=========================================================================================
		/*document.getElementById("get_location").onclick = function() {
			var success = function(position) {
				var latitude = position.coords.latitude,
				longitude = position.coords.longitude,
				coords = latitude + "," + longitude;

				alert(coords);
			}

			var error = function() {
				alert("geolocation not supported");
			}

			if (geoPosition.init()) {
				geoPosition.getCurrentPosition(success, error);
			}
			
			return false;
		};*/
	</script>
</body>
</html>